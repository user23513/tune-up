<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.up.tune.emp.attd.mapper.AttdMapper">

	<select id="attdList" resultType="co.up.tune.emp.vo.AttdVO">
    	SELECT * 
    	FROM ATTD
	</select>	
	
	  <select id="attdGoodList" resultType="co.up.tune.emp.vo.AttdVO">
    	SELECT * 
    	FROM ATTD
    	WHERE ST=601
    	ORDER BY ATDC_DT DESC
	</select>
	
	<select id="attdBadList" resultType="co.up.tune.emp.vo.AttdVO">
    	SELECT * 
    	FROM ATTD
    	WHERE ST=602
    	ORDER BY ATDC_DT DESC
	</select>
	
	<select id="myAttdList" resultType="co.up.tune.emp.vo.AttdVO" parameterType="co.up.tune.emp.vo.AttdUpVO">
    	SELECT * 
    	FROM ATTDUP
    	WHERE EMP_NO = #{empNo}
    	AND ST = #{ST}
    	ORDER BY ATTD_UP DESC
	</select>	
	
	<insert id="attdToday" parameterType="co.up.tune.emp.vo.AttdVO">
		INSERT INTO ATTD
		VALUES (sysdate,#{empNo},#{nm},#{dept},#{position},sysdate,sysdate,sysdate,sysdate,'601')
	</insert>
	
	<insert id="afwkToday" parameterType="co.up.tune.emp.vo.AttdVO">
		<selectKey keyProperty="wktm,ovtm" order="BEFORE" resultType="map">
				<![CDATA[
            SELECT 
				CASE WHEN ATDC_DTTM < AFWK_DTTM 
				THEN ATDC_DTTM-AFWK_DTTM END 
				FROM ATTD
       			 ]]>
		</selectKey>
		
		INSERT INTO ATTD
		VALUES (sysdate,#{empNo},#{nm},#{dept},#{position},#{wktm},sysdate,sysdate,sysdate,'601')
	</insert>
	
	
	
</mapper>