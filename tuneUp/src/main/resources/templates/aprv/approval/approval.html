<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>전자결재 - 나의 승인</title>
<link rel="stylesheet" type="text/css"
	href="https://cdn.datatables.net/v/bs5/dt-1.12.1/datatables.min.css" />
<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript"
	src="https://cdn.datatables.net/v/bs5/dt-1.12.1/datatables.min.js"></script>

<style>
table * {
	border-radius: 5px 5px 5px 5px;
}

.form-control {
	justify-content: end;
}

*:focus {
	outline: 0;
}
</style>
</head>

<body>
	<!-- ======= Main ======= -->
	<main id="main" class="main" layout:fragment="content">

		<script>
		
		loadin(); // 로딩화면 
		function loadin(load) {
 			LoadingWithMask("/assets/img/load.gif"); //동작
  			setTimeout("closeLoadingWithMask()", 500); //밀리초 후 종료
		} 
		function LoadingWithMask(gif) {
			var maskHeight = $(document).height();
			var maskWidth  = window.document.body.clientWidth;
  			
			let mask = "<div id='mask' class='row' style='position:absolute; z-index:9000; background-color:#ffffff; text-align:center; display:none; left:0; top:0;'></div>";
  			
			let loadingImg = '';
  			loadingImg += "<div id='loadingImg' class='col align-self-center'>";    
 			loadingImg += " <img src='"+ gif + "' style='position:relative; width: 10%; display: block; margin: 0px auto;'/>";
 			loadingImg += "</div>";
 		
 			$('#main').append(mask);
 			$('#mask').css({'width' : maskWidth +20 , 'height': maskHeight +60});
  			$('#mask').append(loadingImg);
  			$('#mask').show();
		}
		function closeLoadingWithMask() {    
			$('#mask').remove();
			$('#mask').empty();
		}	
	$(document).ready(function() {
	
		//데이터테이블
		$('#approvalTable').DataTable({
			"dom":'lftip',
			"language": {
		    "search": ""
		  	},
			lengthChange: false,
			ordering: false,
			info: false
		
		});
		
		//상태카테고리변경
		$("#approvalBtns").on("click", "button", e=>{
				let aprvSt = $(e.target).data("st"); 	
				location.href=`/approval?aprvSt=${aprvSt}`;
		});
			
	
	/* 	approvalSelect();//상세조회
		function aprvSelect() {
			$("#approvaltb").on("click", ".select", e=>{
				let no = $(e.target).data("no"); //글번호
				$("#aprvNo").val(no)
				$("#aprvfrm").submit();
			})
		} */
	
	});
	</script>

		<!--section -->
		<section class="section">

			<div class="card">
				<div class="card-body">
					<br>
					<!--Page Title -->
					<div class="pagetitle">
						<h1>전자결재</h1>
						<nav>
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="aprvReq">나의 신청</a></li>
								<li class="breadcrumb-item active">나의 승인</li>
								<li class="breadcrumb-item"><a href="aprvAdmin"
									th:if="${session.auth == 'ADMIN'}">관리 기능</a></li>
							</ol>
						</nav>
					</div>
					<!-- End Page Title -->

					<!-- Tabs nav -->
					<ul class="nav nav-tabs nav-tabs-bordered" id="aprvTab"
						role="tablist">
						<li class="nav-item" role="presentation">
							<button class="nav-link active" id="aprv-tab"
								data-bs-toggle="tab" data-bs-target="#aprv-list" type="button"
								role="tab" aria-controls="list" aria-selected="true">승인하기</button>
						</li>
					</ul>
					<!-- End nav -->

					<!-- Tabs -->
					<div class="tab-content pt-2" id="aprvTabContent">
						<div class="tab-pane fade show active" id="aprv-list"
							role="tabpanel" aria-labelledby="aprv-tab">

							<br>
							<!-- Card with an image on left -->
							<div class="card mb-3">
								<div class="row g-0">
									<div class="col-md-4">
										<img src="assets/img/approval.jpg"
											class="img-fluid rounded-start" alt="..."
											style="width: 350px;">
									</div>
									<div class="col-md-8">
										<div class="card-body">
											<br>
											<h5 class="card-title">결재대기목록</h5>
											<p class="card-text">나에게 참조 또는 상신된 결재목록입니다. 문서를 검토하여
												승인하거나 반려할 수 있습니다. 일정 기간 동안 결재를 위임을 설정할 수 있습니다.</p>
											<button type="button" class="btn btn-primary"
												data-bs-toggle="modal" data-bs-target="#signModal">
												<i class="ri-pencil-fill"> 나의 서명 관리</i>
											</button>
											<button type="button" class="btn btn-primary"
												data-bs-toggle="modal" data-bs-target="#trustModal">
												<i class="ri-account-pin-circle-fill"> 결재 위임자 설정</i>
											</button>


										</div>
									</div>
								</div>
							</div>
							<!-- End Card with an image on left -->


							<div class="card">
								<div class="card-body">
									<!-- btns -->
									<div class="row">
										<div class="col text-center">
											<br>
											<div class="btn-group" role="group" id="approvalBtns"
												aria-label="Approval List" style="width: 100%;">
												<button type="button" th:each="s:${st}"
													class="btn btn-outline-primary" th:text="${s.cdNm}"
													th:data-st="${s.cdNm}">전체</button>
											</div>
										</div>
									</div>
									<!-- end btns -->

									<br>

									<table id="approvalTable" class="display center"
										style="width: 100%">
										<thead hidden="hidden">
											<tr>
												<th>내용</th>
											</tr>
										</thead>
										<tbody id="aprvtb">
											<tr class="list-group" th:each="p : ${approval}">
												<td class="list-group-item" th:data-no="${p.aprvNo}">
													<div
														class="d-flex justify-content-between align-items-center">
														<p class="mb-1 fw-bold" th:text="${p.ttl}">
															><input class="form-check-input me-1" type="checkbox"
																th:value="${p.aprvNo}" aria-label="...">제목
														</p>
														<span th:unless="${p.reqSt == '반려' or p.reqSt =='완료' }"
															th:text="진행" class="badge bg-primary rounded-pill"
															style="height: 25px">진행</span> <span
															th:if="${p.reqSt == '반려' or p.reqSt =='완료'  }"
															th:text="${p.reqSt}"
															class="badge bg-secondary rounded-pill"
															style="height: 25px">완료</span>
													</div> <small>And some small print.</small>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>

						</div>
					</div>
					<!-- End Tabs -->
				</div>
			</div>

		</section>
		<!-- End section -->

		<!-- Modal -->

		<div class="modal fade" id="signModal" tabindex="-1"
			data-bs-backdrop="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body" id="sCntn">내용</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">닫기</button>
						<button type="button" class="btn btn-primary">저장</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="trustModal" tabindex="-1"
			data-bs-backdrop="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body" id="tCntn">내용</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">닫기</button>
						<button type="button" class="btn btn-primary">저장</button>
					</div>
				</div>
			</div>
		</div>
		<!-- End Modal-->

		<!-- Scrolling Modal -->
		<div class="modal fade" id="viewModal" tabindex="-1"
			data-bs-backdrop="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body" id="VCntn" style="min-height: 750px;">
						내용</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">닫기</button>
						<button type="button" class="btn btn-primary">수정</button>
					</div>
				</div>
			</div>
		</div>
		<!-- End Scrolling Modal-->




	</main>
	<!-- End main -->
</body>
</html>