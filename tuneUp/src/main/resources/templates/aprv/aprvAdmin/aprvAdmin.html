<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>전자결재 - 관리 기능</title>
<script src="/js/jquery-3.6.1.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<link rel="stylesheet"
	href="https://cdn.datatables.net/v/dt/dt-1.11.4/r-2.2.9/datatables.min.css" />
<script
	src="https://cdn.datatables.net/v/dt/dt-1.11.4/r-2.2.9/datatables.min.js"></script>
<!-- ========= -->
<link rel="stylesheet" type="text/css"
	href="https://cdn.datatables.net/v/bs5/dt-1.12.1/datatables.min.css" />

<script type="text/javascript"
	src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript"
	src="https://cdn.datatables.net/v/bs5/dt-1.12.1/datatables.min.js"></script>
<script>
	$(document).ready(function() {
		aprvSelect();
		formSelect();
		
		//datatables
		$('#aprvTable').DataTable({
			//컬럼 갯수
			colums: [
				
				{data:"ttl"},
				{data:"empNo"},
				{data:"dttm"},
				{data:"reqSt"},
				{data:"aprvAuth"}
			],
			//컬럼 넓이
			columnDefs: [
				{targets:0, width:400},
				{targets:1, width:50},
				{targets:2, width:50},
				{targets:3, width:50},
				{targets:4, width:50}
			],
			//표시 건수 기능 숨기기
			lengthChange: false,
			//정렬 기능 숨기기
			ordering: false,
			//정보 표시 숨기기
			info: false
			
		});
		
		
		$('#formTable').DataTable({
			//컬럼 갯수
			colums: [
				{data:"formCat"},
				{data:"formNm"},
				{data:"empNo"},
				{data:"formAuth"}
			],
			//컬럼 넓이
			columnDefs: [
				{targets:0, width:50},
				{targets:1, width:400},
				{targets:2, width:50},
				{targets:3, width:50}
			],
			//표시 건수 기능 숨기기
			lengthChange: false,
			//정렬 기능 숨기기
			ordering: false,
			//정보 표시 숨기기
			info: false
			
		});
		
		//상세조회
		function aprvSelect() {
			$("#aprvtb").on("click", ".select", e=>{
				let no = $(e.target).data("no"); //글번호
				$("#aprvNo").val(no)
				$("#aprvfrm").submit();
			})
		}
		
		function formSelect() {
			$("#formtb").on("click", ".select", e=>{
				let no = $(e.target).data("no"); //글번호
				$("#formNo").val(no)
				$("#formfrm").submit();
			})
		}
		
		
		
	} );
</script>
<style>
.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
	margin-left: 0px;
	display: inline;
	border: 0px;
}

table, thead>th {
	margin-left: auto;
	margin-right: auto;
}

.location {
	position: relative;
}
</style>
</head>
<body>
	<!-- ======= Main ======= -->
	<main id="main" class="main" layout:fragment="content">



		<!-- ======= Section ======= -->
		<section class="section">

			<div class="card">
				<div class="card-body">

					<br>

					<!-- Page Title -->
					<div class="pagetitle">
						<h1>전자결재</h1>
						<nav>
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="aprvReq">나의 신청</a></li>
								<li class="breadcrumb-item"><a href="approval">나의 승인</a></li>
								<li class="breadcrumb-item active">관리 기능</li>
							</ol>
						</nav>
					</div>
					<!-- End Page Title -->
					<!-- Bordered Tabs -->
					<!-- navList -->
					<ul class="nav nav-tabs nav-tabs-bordered" id="bodyTab"
						role="tablist">
						<li class="nav-item" role="presentation">
							<button class="nav-link active" id="aprv-tab"
								data-bs-toggle="tab" data-bs-target="#aprv-list" type="button"
								role="tab" aria-controls="aprv" aria-selected="true">전체결재확인</button>
						</li>
						<li class="nav-item" role="presentation">
							<button class="nav-link" id="form-tab" data-bs-toggle="tab"
								data-bs-target="#form-list" type="button" role="tab"
								aria-controls="form" aria-selected="false">전체서식관리</button>
						</li>

					</ul>
					<!-- End navList -->



					<div class="tab-content pt-2" id="bodyTabContent">
						<div class="tab-pane fade show active" id="aprv-list"
							role="tabpanel" aria-labelledby="aprv-tab">

							<br>

							<!-- Card with an image on left -->
							<div class="card mb-3">
								<div class="row g-0">
									<div class="col-md-4">
										<img src="assets/img/adminAprv.jpg"
											class="img-fluid rounded-start" alt="..."
											style="width: 350px;">
									</div>
									<div class="col-md-8">
										<div class="card-body">
											<br>
											<h5 class="card-title">전체결재목록</h5>
											<p class="card-text">전체결재문서 목록입니다. 모든 문서를 조회할 수 있습니다. 상세
												조회 화면에서 강제 반려, 결재, 수정 및 삭제할 수 있습니다.</p>
										</div>
									</div>
								</div>
							</div>
							<!-- End Card with an image on left -->

							<div class="card">
								<div class="card-body">

									<br>
									<table id="aprvTable" class="display center"
										style="width: 100%">
										<thead>
											<tr>

												<th>제목</th>
												<th>작성자</th>
												<th>작성일자</th>
												<th>결재상태</th>
												<th>공개상태</th>
											</tr>
										</thead>
										<tbody id="aprvtb">
											<tr th:each="a : ${aprvList}">

												<td th:text="${a.ttl}" class="select"
													th:attr="data-no=${a.aprvNo}"></td>
												<td th:text="${a.empNo}"></td>
												<td th:text="${a.dttm}"></td>
												<td th:text="${a.reqSt}"></td>
												<td th:text="${a.aprvAuth}"></td>
											</tr>
										</tbody>
									</table>


								</div>
							</div>

							<div>
								<form id="aprvfrm" method="post" action="aprvSelect">
									<input type="hidden" th:name="${_csrf.parameterName}"
										th:value="${_csrf.token}"> <input type="hidden"
										id="aprvNo" name="aprvNo">
								</form>
							</div>


						</div>

						<!-- Tabs Gap -->
						<div class="tab-pane fade" id="form-list" role="tabpanel"
							aria-labelledby="form-tab">



							<br>
							<!-- Card with an image on left -->
							<div class="card mb-3">
								<div class="row g-0">
									<div class="col-md-4">
										<img src="assets/img/aprvAdmin.jpg"
											class="img-fluid rounded-start" alt="..."
											style="width: 350px;">
									</div>
									<div class="col-md-8">
										<div class="card-body">
											<br>
											<h5 class="card-title">전체서식목록</h5>
											<p class="card-text">모든 결재서식입니다. 서식을 클릭하시면 해당 양식을 확인하거나
												수정 또는 삭제가 가능합니다.</p>
										</div>
									</div>
								</div>
							</div>
							<!-- End Card with an image on left -->



							<div class="card">
								<div class="card-body">
									<br>

									<table id="formTable" class="display center"
										style="width: 100%">
										<thead>
											<tr>

												<th>카테고리</th>
												<th>제목</th>
												<th>작성자</th>
												<th>공개여부</th>
											</tr>
										</thead>
										<tbody id="formtb">
											<tr th:each="f : ${formList}">
												<td th:text="${f.formCat}"></td>
												<td class="select" th:attr="data-no=${f.formNo}"
													th:text="${f.formNm}"></td>
												<td th:text="${f.empNo}"></td>
												<td th:text="${f.formAuth}"></td>

											</tr>
										</tbody>
									</table>

								</div>
							</div>
						</div>

						<div>
							<form id="formfrm" method="post" action="formSelect">
								<input type="hidden" th:name="${_csrf.parameterName}"
									th:value="${_csrf.token}"> <input type="hidden"
									id="formNo" name="formNo">
							</form>
						</div>
					</div>

				</div>


			</div>
			<!-- End Bordered Tabs -->

		</section>
		<!-- ======= End Section ======= -->




		<!-- Scrolling Modal -->

		<div class="modal fade" id="scrollingModal" tabindex="-1"
			data-bs-backdrop="false">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Scrolling Modal</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body" style="min-height: 750px;">Non omnis
						incidunt qui sed occaecati magni asperiores est mollitia.</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary">Save
							changes</button>
					</div>
				</div>
			</div>
		</div>

		<!-- End Scrolling Modal-->






	</main>
	<!-- End #main -->
</body>
</html>