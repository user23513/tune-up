<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
<meta charset="UTF-8">
<title>내프로젝트-글</title>
<script src="/js/jquery-3.6.1.min.js"></script>
<style>


.pagination {
	margin-left: 300px;
}

#ddbt {
	color: gray;
}

</style>
</head>
<body>
	<main id="main" class="main" layout:fragment="content">

		<section class="section">
			<div class="card">
				<div class="card-body">
					<h5 class="card-title">MY PROJECT</h5>
						<div class="pagetitle">
							
							<br>
						</div>

					<!-- 메인 -->
					<!-- Default Tabs -->

					<ul class="nav nav-tabs d-flex" id="myTabjustified" role="tablist">
						<li class="nav-item flex-fill" role="presentation">
						
							<button class="nav-link w-100 active" id="home-tab"
								data-bs-toggle="tab" data-bs-target="#home-justified"
								type="button" role="tab" aria-controls="home"
								aria-selected="false">Home</button>
						</li>
						<li class="nav-item flex-fill" role="presentation">
							<button class="nav-link w-100" id="pst-tab" data-bs-toggle="tab"
								data-bs-target="#pst" type="button" role="tab"
								aria-controls="pst" aria-selected="true">글</button>
						</li>
						<li class="nav-item flex-fill" role="presentation">
							<button class="nav-link w-100" id="contact-tab"
								data-bs-toggle="tab" data-bs-target="#contact-justified"
								type="button" role="tab" aria-controls="contact"
								aria-selected="false">업무</button>
						</li>
						<li class="nav-item flex-fill" role="presentation">
							<button class="nav-link w-100" id="contact-tab"
								data-bs-toggle="tab" data-bs-target="#contact-justified"
								type="button" role="tab" aria-controls="contact"
								aria-selected="false">일정</button>
						</li>
						<li class="nav-item flex-fill" role="presentation">
							<button class="nav-link w-100" id="contact-tab"
								data-bs-toggle="tab" data-bs-target="#contact-justified"
								type="button" role="tab" aria-controls="contact"
								aria-selected="false">할일</button>

						</li>
							<div style="display: inline-block; margin: 0 5px; float: right;">
								<button type="button" class="btn btn-outline-primary" onclick="location.href='postInsertForm'" >글쓰기</button>
							</div>
					</ul>

					<!-- 글 목록 -->

						<br>
						<div class="tab-pane fade" id="pst" role="tabpanel"
							aria-labelledby="pst-tab">
							<!-- Default Card -->
							<div id="incd">
								<div class="card" th:each="pj :${prjPostList}">
									<div class="card-body">
										<h3 class="card-title">
											<span th:text="${pj.wrtr}	"></span>
											<span th:text="${#dates.format(pj.dttm, 'yyyy-MM-dd')}"></span>
										<!-- 드롭다운 아이콘 -->
											<div class="filter" style="float: right">
												<a class="icon" href="#" data-bs-toggle="dropdown"><i
													class="bi bi-three-dots"></i></a>
												
												<!-- 드롭다운 수정삭제 펼치기 -->
												<ul
													class="dropdown-menu dropdown-menu-end dropdown-menu-arrow" >
													<li class="dropdown-header text-start" > Settings
													</li>
													
													<form id="upFrm" action="postUpdateForm" method="post" >
													<input type="hidden" id="postNo" name="postNo"
														th:value="${pj.postNo}">
														   <button id="up" class="dropdown-item" style="text-align: center">수정</button>
													</form>
													
													<!-- <li><a class="dropdown-item" href="#" style="text-align: center" onclick="location.href='postUpdateForm'">수정</a></li> -->

											
												<!-- <form id="upFrm" action="prjPostUpdate" method="get" >
													<input type="hidden" id="postNo" name="postNo"
														th:value="${pj.postNo}">
														   <button id="delete" class="dropdown-item" style="text-align: center">수정</button>
													</form> -->

														<!-- <form id="upFrm" action="prjPostUpdate">
													<input type="hidden" name="postNo" th:value="${pj.postNo}">
													<button class="btn btn-primary w-100" type="button" id="up">수정</button>
												</form> -->



												<form id="delFrm" action="prjPostDelete" method="post" >
													<input type="hidden" id="postNo" name="postNo"
														th:value="${pj.postNo}">
														   <button id="delete" class="dropdown-item" style="text-align: center">삭제</button>
													</form>
													
												<!-- 	<li><a class="dropdown-item" href="#">삭제</a></li> -->
												</ul>
											</div>

											
										</h3>
										<span th:text="${pj.ttl}" style="font-size: large;"></span><br><br>
										<span th:text="${pj.cntn}" style="font-size: medium;"></span><br><br><br><br>
										
										<!-- <div class="row mb-3">
											<div class="col-sm-10" style="float: right;">
												<input type="text" class="form-control" >
												 <button type="button" class="btn btn-primary btn-sm" style="float: right">등록</button>
											</div>
										</div> -->
										
										<!-- 댓글창 -->
										<form name>
									<div class="form-floating mb-3">
										<textarea class="form-control"
											placeholder="Leave a comment here" id="floatingTextarea"
											style="height: 100px; resize: none"></textarea>
										<label for="floatingTextarea">Comments</label>
									</div>
									<button type="button" class="btn btn-primary btn-sm" style="float: right">등록</button>
										</form>
										
									</div>
								</div>
								<!-- End Default Card -->


				
				<div id="reply" style="display: none;">
				 	<table>
				 		<tbody>
				 			<tr>
				 				<td class="writer">작성자</td>
				 				<td class="wdate">작성일시</td>
				 			</tr>
				 			<tr>
				 				<td class="rcrtn">댓글내용</td>
				 				<td>수정아이콘</td>
				 				<td>삭제아이콘</td>
				 			</tr>
				 		</tbody>
				 	</table>				
				</div>
			
				
				<!-- reply List -->
				<div>
					<table th:each="r : ${replyList}">
				 		<tbody id="rTb">
				 			<tr>
				 				<td th:text="${r.wrtr}">작성자</td>
				 				<td th:text="${r.dttm}">작성일시</td>
				 			</tr>
				 			<tr>
				 				<td th:text="${r.cntn}">댓글내용</td>
				 				<td>수정아이콘</td>
				 				<td>삭제아이콘</td>
				 			</tr>
				 		</tbody>
				 	</table>	
				<hr></div>
			<!-- end reply -->



									<!-- 페이징 -->
									<nav aria-label="Page navigation example">
										<ul class="pagination">
											<li class="page-item"><a class="page-link" href="#"
												aria-label="Previous"> <span aria-hidden="true">&laquo;</span>
											</a></li>
											<li class="page-item"><a class="page-link" href="#">1</a></li>
											<li class="page-item"><a class="page-link" href="#">2</a></li>
											<li class="page-item"><a class="page-link" href="#">3</a></li>
											<li class="page-item"><a class="page-link" href="#"
												aria-label="Next"> <span aria-hidden="true">&raquo;</span>
											</a></li>
										</ul>
									</nav>
								</div>
							</div>
					</div>
				</div>
		</section>




	</main>
	<script type="text/javascript">
	$("#delete").on("click", e=>{
		$("#delFrm").submit();
	});
	
	//수정버튼
	$("#up").on("click", e=>{
		$("#upFrm").submit();
	});
	
	//댓글
	$("#rBtn").on("click", e=>{
		let postNo = $("#postNo").val();
		let cntn = $("#rCntn").val();
		
		$.ajax({
	         url:'ppReplyInsert',
	         type:'post',
	         data:{'postNo':postNo, 'cntn':cntn},
	         dataType:'json',
	         success:function(res){
	            $(".writer").html(res.wrtr);
	            $(".rcrtn").html(res.cntn);
	            
                $("<tr>").append($("<td>").html(res.cntn))
                .prependTo("#rTb")
                
	            $("<tr>").append($("<td>").html(res.wrtr))
                .append($("<td>").html(res.dttm))
                .prependTo("#rTb")
	         
	         } 
	         })
	})
	</script>
</body>
</html>